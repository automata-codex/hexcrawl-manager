---
import Breadcrumbs from './Breadcrumbs.astro';
import KnowledgeNodeContent from './KnowledgeNodeContent.svelte';
import KnowledgeTreeDrawer from './KnowledgeTreeDrawer.svelte';

import type { PlacementRef } from '../types';
import type { KnowledgeNodeData } from '@skyreach/schemas';

interface BreadcrumbItem {
  key: string;
  name: string;
  path: string;
}

interface Props {
  node: KnowledgeNodeData;
  nodeKey: string;
  treeId: string;
  tree: KnowledgeNodeData;
  breadcrumbs: BreadcrumbItem[];
  placements: PlacementRef[];
}

const { node, nodeKey, treeId, tree, breadcrumbs, placements } = Astro.props;
---

<div class="knowledge-node-page">
  <div class="page-header">
    <Breadcrumbs items={breadcrumbs} />
    <KnowledgeTreeDrawer
      client:load
      tree={tree}
      treeId={treeId}
      currentNodeKey={nodeKey}
    />
  </div>

  <KnowledgeNodeContent
    client:load
    node={node}
    nodeKey={nodeKey}
    placements={placements}
  />
</div>

<style>
  .page-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 1.5rem;
    flex-wrap: wrap;
    gap: 0.5rem;
  }
</style>
