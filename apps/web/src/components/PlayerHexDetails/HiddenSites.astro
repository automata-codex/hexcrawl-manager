---
import HiddenSitesDetailList from './HiddenSitesDetailList.astro';
import HiddenSitesStringList from './HiddenSitesStringList.astro';

import type { HexData, HiddenSite } from '@skyreach/schemas';

interface Props {
  hex: HexData;
}

const { hex } = Astro.props;

const { hiddenSites = [] } = hex;

// This is a player-facing component, so hide hidden sites if unexplored or none exist
if (!hex.isExplored || hiddenSites.length === 0) {
  return null;
}

function isObjectArray(arr: string[] | HiddenSite[]): arr is HiddenSite[] {
  return arr.length > 0 && typeof arr[0] === 'object' && 'description' in arr[0];
}
---

{
  hiddenSites && hiddenSites.length > 0 && (
    <>
      {isObjectArray(hiddenSites) ? (
        <HiddenSitesDetailList sites={hiddenSites} />
      ) : (
        <HiddenSitesStringList sites={hiddenSites} />
      )}
    </>
  )
}
