---
import IntelligenceReportsTable from './IntelligenceReportsTable.astro';
import type { RoleplayBookData } from '@skyreach/schemas';
import { renderMarkdown } from '../../utils/markdown';

interface Props {
  data: RoleplayBookData;
}

const { data } = Astro.props;
---

<style>
  .roleplay-book {
    margin-top: 2rem;
  }

  .section-title {
    margin-bottom: 0.5rem;
  }

  .cultural-overview {
    line-height: 1.6;
  }

  .variant-name {
    font-weight: 600;
  }

  .dialogue-item {
    font-style: italic;
    margin-bottom: 0.35rem;
    padding-left: 1rem;
    border-left: 3px solid var(--bulma-link-text);
  }
</style>

<div class="roleplay-book">
  <h2 class="title is-3">{data.name}</h2>

  <h3 class="title is-4 section-title">Cultural Overview</h3>
  <div class="cultural-overview">
    <Fragment set:html={renderMarkdown(data.culturalOverview)} />
  </div>

  <h3 class="title is-4 section-title">Prithara Variants</h3>
  <ul>
  {
    data.pritharaVariants.map((variant) => (
      <li>
        <span class="variant-name">{variant.name}</span> â€“ {variant.description}
      </li>
    ))
  }
  </ul>

  <h3 class="title is-4 section-title">RP & Voice Notes</h3>
  <ul>
  {
    data.rpVoiceNotes.map((note) => (
      <li>
        <Fragment set:html={renderMarkdown(note)} />
      </li>
    ))
  }
  </ul>

  <h3 class="title is-4 section-title">Lore Hooks & Hints</h3>
  <ul>
  {
    data.loreHooks.map((hook) => (
      <li>
        <Fragment set:html={renderMarkdown(hook)} />
      </li>
    ))
  }
  </ul>

  <h3 class="title is-4 section-title">Sample Dialogue</h3>
  {
    data.sampleDialogue.map((dialogue) => (
      <div class="dialogue-item">
        <Fragment set:html={renderMarkdown(dialogue)} />
      </div>
    ))
  }

  {
    data.intelligenceReports && (
      <IntelligenceReportsTable
        instructions={data.intelligenceReports.instructions}
        rows={data.intelligenceReports.rows}
      />
    )
  }
</div>
