---
import { SECURITY_ROLE } from '../utils/constants';
import { isAccessAllowed } from '../utils/auth';
import type { SecurityRole } from '../utils/constants';

interface Props {
  role?: SecurityRole;
}

const { role = SECURITY_ROLE.HIDDEN } = Astro.props;
const { clearance } = (Astro.locals.auth().sessionClaims ?? { clearance: null }) as { clearance: string | null };
---
{isAccessAllowed(role, clearance) && <slot />}
