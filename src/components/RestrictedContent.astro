---
import { canAccess } from '../utils/auth';
import { SCOPES } from '../utils/constants';
import type { Scope } from '../types.ts';

interface Props {
  scope?: Scope;
}

const { scope = SCOPES.HIDDEN } = Astro.props;
const { role = null } = (Astro.locals.auth().sessionClaims ?? { role: null }) as { role: string | null };
---
{canAccess(role, scope) && <slot />}
