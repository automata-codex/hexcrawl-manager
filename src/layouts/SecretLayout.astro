---
import Layout from './BaseLayout.astro';
import OpenContent from '../components/Content/OpenContent.astro';
import ComponentLayout from './ComponentLayout.astro';
import SecretContent from '../components/Content/SecretContent.astro';
import { canAccess, getCurrentUserRole } from '../utils/auth';
import { SCOPES } from '../utils/constants';

interface Props {
  title: string;
}

const { title } = Astro.props;

const role = getCurrentUserRole(Astro.locals);
if (canAccess(role, [SCOPES.PLAYER, SCOPES.PUBLIC])) {
  Astro.response.status = 404;
  Astro.response.statusText = 'Not found';
}
---
<SecretContent>
  <ComponentLayout title={title}>
    <slot />
  </ComponentLayout>
</SecretContent>
