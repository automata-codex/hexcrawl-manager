---
import { getEntry } from 'astro:content';

import CharacterDetails from '../../../components/CharacterDetails.astro';
import SecretLayout from '../../../layouts/SecretLayout.astro';

// Get the ID from the incoming server request
const { id } = Astro.params;
if (!id) {
  return new Response(null, {
    status: 404,
    statusText: 'Not found',
  });
}

// Query for the entry directly using the request slug
const characterData = await getEntry('characters', id);

// Redirect if the entry does not exist
if (characterData === undefined) {
  return new Response(null, {
    status: 404,
    statusText: 'Not found',
  });
}

const character = characterData.data;
---

<style>
  .data-container {
    display: flex;
  }

  .data-container > div {
    width: 50%;
  }
</style>
<SecretLayout title={character.fullName}>
  <CharacterDetails character={character} />
</SecretLayout>
