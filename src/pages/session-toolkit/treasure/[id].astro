---
import { getEntry } from 'astro:content';
import TreasureDetail from '../../../components/Treasure/TreasureDetail.astro';
import ComponentLayout from '../../../layouts/ComponentLayout.astro';

// Get the ID from the incoming server request
const { id } = Astro.params;
if (!id) {
  return new Response(null, {
    status: 404,
    statusText: 'Not found'
  });
}

// Query for the entry directly using the request slug
const treasureData = await getEntry('treasure', id);

// Redirect if the entry does not exist
if (treasureData === undefined) {
  return new Response(null, {
    status: 404,
    statusText: 'Not found'
  });
}

const treasure = treasureData.data;
---
<ComponentLayout title=`Treasure: ${treasure.name}`>
  <TreasureDetail treasure={treasure} />
</ComponentLayout>
